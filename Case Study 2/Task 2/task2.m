% Time vector
t = [ 0 0.25 0.5 0.75 ...
    1 1.25 1.5 1.75 ...
    2 2.25 2.5 2.75 ...
    3 3.25 3.5 3.75 ...
    4 4.25 4.5 4.75 ...
    5 5.25 5.5 5.75 ...
    6 6.25 6.5 6.75 ...
    7 7.25 7.5 7.75 ....
8 8.25 8.5 8.75 9 9.25 9.5 9.75 10 10.25 10.5 10.75 11 11.25 11.5 11.75 12 ];

% Biomass vector
X = [
0.117342787404139 0.158731018389056 0.167946732740233 0.123525040138678 ...
0.124982662572416 0.256551363780705 0.0598633891368670 0.246651479954157 ...
0.256642187054661 0.250781745286317 0.118095543439869 0.167822391463391 ...
0.178546982105370 0.260267232712412 0.190917517186242 0.252528613969189 ...
0.185582539466441 0.291580261767395 0.308316388034201 0.428595509422117 ...
0.455585830211025 0.444589710821036 0.501903922865784 0.464794310421441 ...
0.557269450093384 0.550743324915109 0.586862696939234 0.677158775043782 ...
0.770027734848821 0.620939767542000 1.19531269884163 1.00145498801887 ...
1.01629527103922 1.34736521433923 1.23715275317171 1.64227212677139 ...
1.59793319505874 2.53382394828956 2.51141358105043 1.27344971578537 ...
2.26215037333670 1.63784269761602 2.14807109941103 2.22259988693345 ...
2.35777933337034 2.04107487884435 2.52190716843348 2.01994901802561 2.13821366832011 ];
% Select exponential growth region
idx = (t >= 3.25) & (t <= 9.25);

t_exp = t(idx);
X_exp = X(idx);
lnX = log(X_exp);
% Linear fit: ln(X) = a + mu*t
p = polyfit(t_exp, lnX, 1);

mu = p(1);        % slope = growth rate
lnX0 = p(2);      % intercept

yhat = polyval(p, t_exp);  % Predicted values
SS_res = sum((lnX - yhat).^2);  % Residual sum of squares
SS_tot = sum((lnX - mean(lnX)).^2);  % Total sum of squares
R2 = 1 - (SS_res / SS_tot);  % R-squared


fprintf('Average specific growth rate mu = %.3f 1/h\n', mu);
fprintf('RÂ² = %.4f (fit quality)\n', R2);

figure
plot(t_exp, lnX, 'o', 'MarkerSize', 6)
hold on
plot(t_exp, polyval(p, t_exp), '-')
xlabel('Time')
ylabel('ln(X)')
title('Estimation of specific growth rate \mu')
grid on
